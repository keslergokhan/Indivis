@using Indivis.Core.Application.Dtos.CoreEntityDtos.PageSystems.Reads
@using Indivis.Core.Application.Dtos.CoreEntityDtos.Pages.Reads
@using Indivis.Presentation.WebUICms.Models.PageModels;
@using Microsoft.AspNetCore.Html
@using System.Web
@model PageSystemViewOutModel;



@{

    @functions
    {

        public string GetPageItem(ReadPageDto page)
        {
            string htmlItem = $@"<div class=""ms-2 me-auto mb-5"">
                                    <div class=""row"">
                                        <div class=""col-10"">
                                            <a href=""#"" class=""text-dark fw-bolder text-hover-primary mb-1 fs-6"">{page.Name}</a>
                                            <a href=""/"" class=""text-muted fw-bold d-block"">{page.Url.FullPath}</a>
                                        </div>
                                        <div class=""col-2 d-flex "">
                                            <div>
                                                <button class=""btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto"" title=""Ayarlar"" data-kt-menu-trigger=""click"" data-kt-menu-placement=""bottom-end"">
                                                    <img src=""assets/media/icons/duotune/coding/cod001.svg"" />
                                                </button>
                                                <div class=""menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3"" data-kt-menu=""true"">
                                                    <div class=""menu-item px-3"">
                                                        <div class=""menu-content text-muted pb-2 px-3 fs-7 text-uppercase"">Sayfa İşlemleri</div>
                                                    </div>

                                                    <div class=""menu-item px-3"">
                                                        <a href=""#"" class=""menu-link flex-stack px-3"">
                                                            Alt Sayfa Ekle
                                                            <i class=""fas fa-exclamation-circle ms-2 fs-7"" data-bs-toggle=""tooltip"" title=""Mevcut sayfaya bağlı yeni bir alt sayfa ekle""></i>
                                                        </a>
                                                        <a href=""#"" class=""menu-link flex-stack px-3"">
                                                            Detay
                                                            <i class=""fas fa-exclamation-circle ms-2 fs-7"" data-bs-toggle=""tooltip"" title=""Mevcut sayfa hakkında daha fazla bilgi""></i>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>";
            return htmlItem;
        }

        public IHtmlContent ListPageSystems(List<ReadPageSystemDto> pageSystems)
        {

            string allHTML = "";
            foreach (ReadPageSystemDto pageSystem in pageSystems)
            {
                allHTML += $@"
                    <div class=""card page-systems-card mt-10"">
                        <div class=""card"">
                            <div class=""card-header"">
                                <div class=""d-block mt-3"">
                                    <h3 class=""card-title"" data-controller=""{pageSystem.Controller}"" data-action=""{pageSystem.Action}"">{pageSystem.Name}</h3>
                                    <p class=""card-text"" >{pageSystem.Description}</p>
                                </div>
                            </div>
                            <div class=""card-body"">
                                <ol class=""list-group list-group-numbered"">
                                    {ListPageSystemsPages(pageSystem.Pages.ToList())}
                                </ol>

                            </div>
                        </div>
                    </div>
                ";
            }

            return new HtmlString(@"<div class=""col-md-8"">"+ allHTML + "</div>");
        }


        public string ListPageSystemsPages(List<ReadPageDto> pages)
        {
            string altHTML = "";




            foreach (ReadPageDto page in pages)
            {
                string subHtml = "";
                if (page.SubPages != null && page.SubPages.Count > 0)
                {
                    subHtml = @"<ol class=""list-group list-group-numbered ms-10"">" + ListPageSystemsPages(page.SubPages) + "</ol>";
                }

                altHTML += $@"
                    <li class="" list-group-item d-block justify-content-between align-items-start"">
                        {GetPageItem(page)}
                        {subHtml}
                    </li>
                ";
            }

            return altHTML;
        }
    }



}

@ListPageSystems(Model.PageSystems)

<div class="card page-systems-card d-none">
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Başlik</h3>
                </div>
                <div class="card-body">
                    <ol class="list-group list-group-numbered">
                        <li class="list-group-item d-block justify-content-between align-items-start">
                            <div class="ms-2 me-auto mb-5">
                                <div class="row">
                                    <div class="col-10">
                                        <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                        <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf</a>
                                    </div>
                                    <div class="col-2 d-flex ">
                                        <div>
                                            <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                            </button>
                                            <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                <div class="menu-item px-3">
                                                    <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                </div>
                                                
                                                <div class="menu-item px-3">
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Alt Sayfa Ekle
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                    </a>
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Detay
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ol class="list-group list-group-numbered ms-10">
                                <li class="list-group-item d-block justify-content-between align-items-start">
                                    <div class="ms-2 me-auto mb-5">
                                        <div class="row">
                                            <div class="col-10">
                                                <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                                <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf-merhaba-dunya-sdfsdf-merhaba-dunya-sdfsdf-merhaba-dunya-sdfsdf</a>
                                            </div>
                                            <div class="col-2 d-flex ">
                                                <div>
                                                    <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                        <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                                    </button>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                        <div class="menu-item px-3">
                                                            <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                        </div>

                                                        <div class="menu-item px-3">
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Alt Sayfa Ekle
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                            </a>
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Detay
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </li>
                                <li class="list-group-item d-block justify-content-between align-items-start">

                                    <div class="ms-2 me-auto mb-5">
                                        <div class="row">
                                            <div class="col-10">
                                                <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                                <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf</a>
                                            </div>
                                            <div class="col-2 d-flex ">
                                                <div>
                                                    <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                        <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                                    </button>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                        <div class="menu-item px-3">
                                                            <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                        </div>

                                                        <div class="menu-item px-3">
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Alt Sayfa Ekle
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                            </a>
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Detay
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="list-group-item d-block justify-content-between align-items-start">

                                    <div class="ms-2 me-auto mb-5">
                                        <div class="row">
                                            <div class="col-10">
                                                <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                                <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf</a>
                                            </div>
                                            <div class="col-2 d-flex ">
                                                <div>
                                                    <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                        <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                                    </button>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                        <div class="menu-item px-3">
                                                            <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                        </div>

                                                        <div class="menu-item px-3">
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Alt Sayfa Ekle
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                            </a>
                                                            <a href="#" class="menu-link flex-stack px-3">
                                                                Detay
                                                                <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </li>
                            </ol>
                        </li>
                        <li class="list-group-item d-block justify-content-between align-items-start">
                            <div class="ms-2 me-auto mb-5">
                                <div class="row">
                                    <div class="col-10">
                                        <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                        <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf</a>
                                    </div>
                                    <div class="col-2 d-flex ">
                                        <div>
                                            <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                            </button>
                                            <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                <div class="menu-item px-3">
                                                    <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                </div>

                                                <div class="menu-item px-3">
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Alt Sayfa Ekle
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                    </a>
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Detay
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item d-block justify-content-between align-items-start">

                            <div class="ms-2 me-auto mb-5">
                                <div class="row">
                                    <div class="col-10">
                                        <a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">Brad Simmons</a>
                                        <a href="/" class="text-muted fw-bold d-block">/deneme-merhaba-dunya-sdfsdf</a>
                                    </div>
                                    <div class="col-2 d-flex ">
                                        <div>
                                            <button class="btn btn-sm btn-icon btn-bg-light btn-active-color-primary ms-auto" title="Ayarlar" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                                                <img src="assets/media/icons/duotune/coding/cod001.svg" />
                                            </button>
                                            <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px py-3" data-kt-menu="true">
                                                <div class="menu-item px-3">
                                                    <div class="menu-content text-muted pb-2 px-3 fs-7 text-uppercase">Sayfa İşlemleri</div>
                                                </div>

                                                <div class="menu-item px-3">
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Alt Sayfa Ekle
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfaya bağlı yeni bir alt sayfa ekle"></i>
                                                    </a>
                                                    <a href="#" class="menu-link flex-stack px-3">
                                                        Detay
                                                        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Mevcut sayfa hakkında daha fazla bilgi"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>

                </div>

            </div>
        </div>

        <div class="col-md-4">

        </div>
    </div>
</div>



<ol class="list-group list-group-numbered mt-5">
    @{
        ushort row = 1;
    }

    
    @foreach (ReadPageSystemDto pageSystems in Model.PageSystems.ToList())
    {
        <li class="list-group-item d-block justify-content-between align-items-start">
            <div class="ms-2 me-auto">
                <div class="fw-bold">@pageSystems.Name <a href="/pageCms/createPage/@pageSystems.Id">+ Yeni Sayfa Ekle</a></div>
                @pageSystems.Description
                <br /><br />
                Siteme bağlı sayfalar
                @if (pageSystems.Pages.Count > 0)
                {
                    <div>
                        <ol class="list-group list-group-numbered">
                            @foreach (ReadPageDto pageItem in pageSystems.Pages)
                            {
                                <li class="list-group-item">
                                    @pageItem.Name
                                    <a href="@pageItem.Url.FullPath">@pageItem.Url.FullPath</a>
                                </li>
                            }
                            
                        </ol>
                    </div>
                }
                
            </div>
            <span class="badge bg-primary rounded-pill">@pageSystems.Pages.Count</span>
        </li>

        
        row++;
    }
    
</ol>
  

